% Aerodynamic calculation based on the airfoil data from xfoil and geometry

%TESTTTTTTTTTTTTTTTT

g=9.81;
rho=1.225;
miu=1.78938*10^(-5);
e=0.9;

angle=-5:0.5:12.5;        % deg

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%       Airfoils data        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% E387 data   from -3deg to 12deg
cl_w=[
    0.0604
    0.0703
    0.0807
    0.0911
    0.1018
    0.1120
    0.1224
    0.1331
    0.1432
    0.1533
    0.1623
    0.1709
    0.1800
    0.1895
    0.1989
    0.2081
    0.2178
    0.2283
    0.2383
    0.2487
    0.2587
    0.2690
    0.2796
    0.2898
    0.3000
    0.3097
    0.3192
    0.3283
    0.3373
    0.3463
    0.3554
    0.3652
    0.3762
    0.3903
    0.4124
    0.4391
    0.4613
    0.4802
    0.4973
    0.5141
    0.5236
    0.5336
    0.5439
    0.5542
    0.5644
    0.5746
    0.5847
    0.5947
    0.6046
    0.6144
    0.6241
    0.6338
    0.6442
    0.6546
    0.6650
    0.6752
    0.6854
    0.6955
    0.7053
    0.7150
    0.7247
    0.7345
    0.7450
    0.7556
    0.7660
    0.7764
    0.7865
    0.7967
    0.8065
    0.8162
    0.8257
    0.8356
    0.8462
    0.8567
    0.8670
    0.8772
    0.8870
    0.8969
    0.9061
    0.9156
    0.9260
    0.9365
    0.9468
    0.9569
    0.9666
    0.9760
    0.9850
    0.9949
    1.0053
    1.0152
    1.0234
    1.0320
    1.0420
    1.0511
    1.0593
    1.0678
    1.0759
    1.0836
    1.0918
    1.1003
    1.1085
    1.1167
    1.1242
    1.1326
    1.1408
    1.1475
    1.1563
    1.1627
    1.1705
    1.1773
    1.1842
    1.1910
    1.1970
    1.2048
    1.2102
    1.2167
    1.2207
    1.2253
    1.2301
    1.2342
    1.2390
    1.2433
    1.2464
    1.2527
    1.2598
    1.2655
    1.2700
    1.2762
    1.2630
    1.2633
    1.2667
    1.2719
    1.2766
    1.2801
    1.2828
    1.2844
    1.2949
    1.2940
    1.2986
    1.3044
    1.3015
    1.3076
    1.3022
    1.3099
    1.3123
    1.3097
    1.3117
    1.3124
    1.3141
    1.3132
    1.3110
    ]'
a0_w=0.1091;
alfa0_w=-3.55;
cd_w=[0.0094
    0.0092
    0.0091
    0.0090
    0.0090
    0.0088
    0.0087
    0.0087
    0.0085
    0.0084
    0.0081
    0.0078
    0.0076
    0.0073
    0.0072
    0.0070
    0.0069
    0.0068
    0.0068
    0.0068
    0.0067
    0.0067
    0.0067
    0.0066
    0.0066
    0.0065
    0.0065
    0.0064
    0.0063
    0.0063
    0.0062
    0.0062
    0.0061
    0.0061
    0.0060
    0.0060
    0.0061
    0.0061
    0.0061
    0.0062
    0.0063
    0.0063
    0.0063
    0.0063
    0.0063
    0.0064
    0.0064
    0.0064
    0.0065
    0.0065
    0.0066
    0.0067
    0.0067
    0.0067
    0.0067
    0.0067
    0.0068
    0.0068
    0.0069
    0.0069
    0.0070
    0.0071
    0.0071
    0.0071
    0.0072
    0.0072
    0.0072
    0.0073
    0.0073
    0.0074
    0.0075
    0.0076
    0.0076
    0.0076
    0.0077
    0.0077
    0.0078
    0.0079
    0.0080
    0.0081
    0.0081
    0.0081
    0.0082
    0.0082
    0.0083
    0.0084
    0.0085
    0.0086
    0.0087
    0.0087
    0.0089
    0.0090
    0.0091
    0.0092
    0.0094
    0.0096
    0.0098
    0.0100
    0.0102
    0.0104
    0.0106
    0.0108
    0.0110
    0.0112
    0.0114
    0.0117
    0.0118
    0.0122
    0.0124
    0.0127
    0.0130
    0.0132
    0.0136
    0.0138
    0.0142
    0.0145
    0.0149
    0.0153
    0.0157
    0.0162
    0.0165
    0.0169
    0.0174
    0.0176
    0.0177
    0.0180
    0.0183
    0.0185
    0.0198
    0.0204
    0.0208
    0.0210
    0.0213
    0.0217
    0.0222
    0.0227
    0.0226
    0.0234
    0.0237
    0.0240
    0.0249
    0.0251
    0.0262
    0.0264
    0.0270
    0.0279
    0.0286
    0.0293
    0.0300
    0.0309
    0.0319]';
  
cm_w=[-0.0823
-0.0814
-0.0809
-0.0808
-0.0807
-0.0812
-0.0817
-0.0788
-0.0799
-0.0801
-0.0804
-0.0806
-0.0808
-0.0809
-0.0811
-0.0812
-0.0814
-0.0814
-0.081
-0.0807
-0.0799
-0.0792
-0.0783
-0.0767
-0.0747
-0.0713
-0.0668
-0.0625
-0.059
-0.0555
-0.048
-0.0461
-0.048
-0.0529]';

% NACA 0008 data from -4 to 7.5deg
cl_h=[-0.4617
-0.4194
-0.375
-0.331
-0.2863
-0.2252
-0.1223
-0.0188
0
0.0189
0.1224
0.2253
0.2864
0.331
0.3751
0.4194
0.4617
0.5049
0.5496
0.5974
0.6412
0.6863
0.7242
0.745
]';
a0_h=0.1124;
alfa0_h=0;
cd_h=[0.0116
0.01
0.009
0.0084
0.0081
0.0083
0.0085
0.0084
0.0083
0.0084
0.0085
0.0083
0.0081
0.0084
0.009
0.01
0.0116
0.0137
0.0159
0.0181
0.0223
0.0261
0.0321
0.0417
]';
cm_h=[0.002
0.0039
0.0063
0.0094
0.0132
0.0136
0.0043
-0.0058
0
0.0059
-0.0042
-0.0135
-0.0131
-0.0093
-0.0061
-0.0038
-0.0018
0.0001
0.0022
0.0042
0.0061
0.0081
0.0108
0.0134
]';
% NACA 0010 data from -4deg to 7.5deg
cl_v=[-0.4955
-0.4513
-0.4059
-0.3598
-0.3135
-0.2693
-0.2205
-0.1161
0.0001
0.1163
0.2206
0.2692
0.3136
0.3598
0.4058
0.4513
0.4956
0.5389
0.5799
0.622
0.6648
0.7058
0.7504
0.7877
]';
a0_v=0.1163;
alfa0_v=0;
cd_v=[0.0111
0.0104
0.0098
0.0094
0.0092
0.0092
0.0095
0.0099
0.01
0.0099
0.0095
0.0092
0.0092
0.0094
0.0098
0.0104
0.0111
0.012
0.0135
0.0149
0.0163
0.0187
0.0205
0.0253
]';
cm_v=[-0.0816
   -0.0813
   -0.0811
   -0.0809
   -0.0808
   -0.0805
   -0.0804
   -0.0803
   -0.0800
   -0.0798
   -0.0796
   -0.0792
   -0.0790
   -0.0787
   -0.0785
   -0.0782
   -0.0779
   -0.0777
   -0.0775
   -0.0773
   -0.0770
   -0.0768
   -0.0767
   -0.0764
   -0.0762
   -0.0758
   -0.0754
   -0.0749
   -0.0744
   -0.0738
   -0.0733
   -0.0729
   -0.0728
   -0.0733
   -0.0756
   -0.0791
   -0.0815
   -0.0832
   -0.0846
   -0.0859
   -0.0855
   -0.0853
   -0.0851
   -0.0850
   -0.0848
   -0.0846
   -0.0844
   -0.0841
   -0.0839
   -0.0836
   -0.0833
   -0.0830
   -0.0828
   -0.0827
   -0.0825
   -0.0823
   -0.0821
   -0.0819
   -0.0816
   -0.0814
   -0.0811
   -0.0808
   -0.0807
   -0.0806
   -0.0804
   -0.0803
   -0.0801
   -0.0799
   -0.0796
   -0.0793
   -0.0790
   -0.0788
   -0.0787
   -0.0785
   -0.0784
   -0.0782
   -0.0780
   -0.0777
   -0.0774
   -0.0771
   -0.0770
   -0.0768
   -0.0767
   -0.0765
   -0.0763
   -0.0759
   -0.0756
   -0.0754
   -0.0752
   -0.0750
   -0.0745
   -0.0741
   -0.0739
   -0.0736
   -0.0731
   -0.0727
   -0.0722
   -0.0716
   -0.0712
   -0.0708
   -0.0703
   -0.0699
   -0.0693
   -0.0689
   -0.0685
   -0.0678
   -0.0675
   -0.0668
   -0.0663
   -0.0656
   -0.0650
   -0.0644
   -0.0637
   -0.0632
   -0.0623
   -0.0617
   -0.0606
   -0.0597
   -0.0588
   -0.0577
   -0.0567
   -0.0557
   -0.0544
   -0.0536
   -0.0531
   -0.0522
   -0.0512
   -0.0505
   -0.0466
   -0.0451
   -0.0440
   -0.0432
   -0.0425
   -0.0415
   -0.0405
   -0.0393
   -0.0394
   -0.0380
   -0.0373
   -0.0368
   -0.0353
   -0.0349
   -0.0333
   -0.0331
   -0.0324
   -0.0312
   -0.0305
   -0.0298
   -0.0291
   -0.0283
   -0.0274
]';


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%         Whole Wing         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a_w=a0_w/(1+(57.3*a0_w)/(3.14*e*AR_w));
CL_w=a_w*(angle(5:1:27)-alfa0_w);       % from -3deg to 8deg

% CDi_w=zeros(1,15);
% CD_w=zeros(1,15);
% LD_w=zeros(1,15);
% for i=1:1:15
%     CDi_w(i)=CL_w(i)^2/(3.14*e*AR_w);
%     CD_w(i)=cd_w(i+10)+CDi_w(i);
%     LD_w(i)=CL_w(i)/CD_w(i);
% end
CDi_w=zeros(1,23);
CD_w=zeros(1,23);
LD_w=zeros(1,23);
for i=1:1:23
    CDi_w(i)=CL_w(i)^2/(3.14*e*AR_w);
    CD_w(i)=cd_w(i)+CDi_w(i);
    LD_w(i)=CL_w(i)/CD_w(i);
end

CDi_w;
CD_w;
LD_w;

figure(3)
% plot(angle(11:1:25),LD_w)
% figure(3)
% plot(angle(11:1:25),CD_w)
% figure(4)
% plot(angle(11:1:25),CDi_w)
% figure(5)
% plot(angle(11:1:25),cd_w(11:1:25))
subplot(3,3,1)
plot(angle(5:1:27),LD_w)
title('L/D to alfa')
subplot(3,3,2)
plot(angle(5:1:27),CD_w)
title('CD to alfa')
subplot(3,3,3)
plot(angle(5:1:27),CDi_w)
title('CDi to alfa')
subplot(3,3,4)
plot(angle(5:1:27),cd_w(1:1:23))
title('cd to alfa')
subplot(3,3,5)
plot(angle(5:1:27),cl_w(1:1:23))
title('cl to alfa')
hold on
subplot(3,3,6)
plot(CD_w(1:1:23),CL_w(1:1:23))
title('CL to CD')
subplot(3,3,5)
plot(angle(5:1:27),CL_w(1:1:23))
title('CL to alfa')
subplot(3,3,8)
plot(cd_w(1:1:23),cl_w(1:1:23))
title('cl to cd')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        Horizon Tail        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a_h=a0_h/(1+(57.3*a0_h)/(3.14*e*AR_h));
CL_h=a_h*(angle(1:1:24)-alfa0_h);       % from -4deg to 7.5deg
CDi_h=zeros(1,24);
CD_h=zeros(1,24);
for i=1:1:24
    CDi_h(i)=CL_h(i)^2/(3.14*e*AR_h);
    CD_h(i)=cd_h(i)+CDi_h(i);
end
CDi_h;
CD_h;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%       Vertical Tail        %TEST........
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a_v=a0_v/(1+(57.3*a0_v)/(3.14*e*AR_v));
CL_v=a_v*(angle(1:1:24)-alfa0_v);       % from -4deg to 7.5deg
CDi_v=zeros(1,24);
CD_v=zeros(1,24);
for i=1:1:24
    CDi_v(i)=CL_v(i)^2/(3.14*e*AR_v);
    CD_v(i)=cd_v(i)+CDi_v(i);
end
CDi_v;
CD_v;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%          Fuselage          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
CD_f=0.007;




% cl=0.6;
% v=14.5;
% qdyn=0.5*rho*v^2;
% Re=rho*v*MAC_w/miu
% L=qdyn*cl*S_w
% G=m_tot*g

% position of cg



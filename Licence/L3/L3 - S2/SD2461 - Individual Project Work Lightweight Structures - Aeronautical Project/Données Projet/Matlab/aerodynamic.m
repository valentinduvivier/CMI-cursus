% Aerodynamic calculation based on the airfoil data from xfoil and geometry


g=9.81;
rho=1.225;
miu=1.78938*10^(-3);
e=0.9;

angle=-5:0.5:12.5;        % deg

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%       Airfoils data        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Clark V data   from -5deg to 12.5deg
cl_w=[-0.1134
-0.0577
0.0024
0.0615
0.1125
0.1691
0.2238
0.2752
0.329
0.3739
0.4264
0.4979
0.5826
0.6586
0.7048
0.75
0.7939
0.8368
0.8769
0.9141
0.9537
0.9929
1.0333
1.0715
1.1094
1.1471
1.1839
1.2198
1.2501
1.279
1.2947
1.3197
1.3447
1.3625
1.3572
1.3766
]'
a0_w=0.1067;
alfa0_w=-4;
cd_w=[0.012
0.011
0.0103
0.0096
0.009
0.0084
0.0077
0.0071
0.0066
0.0059
0.0058
0.0059
0.0061
0.0062
0.0064
0.0066
0.0068
0.0071
0.0075
0.0081
0.0087
0.0094
0.0102
0.0111
0.012
0.0128
0.0137
0.0146
0.016
0.0174
0.0197
0.0215
0.0233
0.0256
0.0298
0.0322
]';
  
cm_w=[-0.1027
-0.1026
-0.1034
-0.104
-0.1029
-0.1031
-0.1032
-0.1024
-0.102
-0.0992
-0.0978
-0.1007
-0.1069
-0.1114
-0.1095
-0.1073
-0.1049
-0.1021
-0.0989
-0.0951
-0.092
-0.0889
-0.0861
-0.0831
-0.0801
-0.0771
-0.074
-0.0709
-0.067
-0.0631
-0.0574
-0.0531
-0.0493
-0.0448
-0.0383
-0.0352
]';
% NACA 0008 data from -4 to 7.5deg
cl_h=[-0.4617
-0.4194
-0.375
-0.331
-0.2863
-0.2252
-0.1223
-0.0188
0
0.0189
0.1224
0.2253
0.2864
0.331
0.3751
0.4194
0.4617
0.5049
0.5496
0.5974
0.6412
0.6863
0.7242
0.745
]';
a0_h=0.1124;
alfa0_h=0;
cd_h=[0.0116
0.01
0.009
0.0084
0.0081
0.0083
0.0085
0.0084
0.0083
0.0084
0.0085
0.0083
0.0081
0.0084
0.009
0.01
0.0116
0.0137
0.0159
0.0181
0.0223
0.0261
0.0321
0.0417
]';
cm_h=[0.002
0.0039
0.0063
0.0094
0.0132
0.0136
0.0043
-0.0058
0
0.0059
-0.0042
-0.0135
-0.0131
-0.0093
-0.0061
-0.0038
-0.0018
0.0001
0.0022
0.0042
0.0061
0.0081
0.0108
0.0134
]';
% NACA 0010 data from -4deg to 7.5deg
cl_v=[-0.4955
-0.4513
-0.4059
-0.3598
-0.3135
-0.2693
-0.2205
-0.1161
0.0001
0.1163
0.2206
0.2692
0.3136
0.3598
0.4058
0.4513
0.4956
0.5389
0.5799
0.622
0.6648
0.7058
0.7504
0.7877
]';
a0_v=0.1163;
alfa0_v=0;
cd_v=[0.0111
0.0104
0.0098
0.0094
0.0092
0.0092
0.0095
0.0099
0.01
0.0099
0.0095
0.0092
0.0092
0.0094
0.0098
0.0104
0.0111
0.012
0.0135
0.0149
0.0163
0.0187
0.0205
0.0253
]';
cm_v=[0.0075
0.0096
0.0117
0.0138
0.0162
0.0192
0.0214
0.012
0
-0.012
-0.0213
-0.0191
-0.0161
-0.0137
-0.0115
-0.0095
-0.0074
-0.0053
-0.0031
-0.0007
0.0015
0.0043
0.0064
0.0088
]';


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%         Whole Wing         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a_w=a0_w/(1+(57.3*a0_w)/(3.14*e*AR_w));
% CL_w=a_w*(angle(11:1:25)-alfa0_w);       % from 0deg to 7deg
CL_w=a_w*(angle(1:1:29)-alfa0_w);       % from -5deg to 9deg

% CDi_w=zeros(1,15);
% CD_w=zeros(1,15);
% LD_w=zeros(1,15);
% for i=1:1:15
%     CDi_w(i)=CL_w(i)^2/(3.14*e*AR_w);
%     CD_w(i)=cd_w(i+10)+CDi_w(i);
%     LD_w(i)=CL_w(i)/CD_w(i);
% end
CDi_w=zeros(1,29);
CD_w=zeros(1,29);
LD_w=zeros(1,29);
for i=1:1:29
    CDi_w(i)=CL_w(i)^2/(3.14*e*AR_w);
    CD_w(i)=cd_w(i)+CDi_w(i);
    LD_w(i)=CL_w(i)/CD_w(i);
end

CDi_w;
CD_w;
LD_w;

figure(2)
% plot(angle(11:1:25),LD_w)
% figure(3)
% plot(angle(11:1:25),CD_w)
% figure(4)
% plot(angle(11:1:25),CDi_w)
% figure(5)
% plot(angle(11:1:25),cd_w(11:1:25))
subplot(3,3,1)
plot(angle(1:1:29),LD_w)
title('L/D to alfa')
subplot(3,3,2)
plot(angle(1:1:29),CD_w)
title('CD to alfa')
subplot(3,3,3)
plot(angle(1:1:29),CDi_w)
title('CDi to alfa')
subplot(3,3,4)
plot(angle(1:1:29),cd_w(1:1:29))
title('cd to alfa')
subplot(3,3,5)
plot(angle(1:1:29),cl_w(1:1:29))
title('cl to alfa')
hold on
subplot(3,3,6)
plot(CD_w(1:1:29),CL_w(1:1:29))
title('CL to CD')
subplot(3,3,5)
plot(angle(1:1:29),CL_w(1:1:29))
title('CL to alfa')
subplot(3,3,8)
plot(cd_w(1:1:29),cl_w(1:1:29))
title('cl to cd')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        Horizon Tail        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a_h=a0_h/(1+(57.3*a0_h)/(3.14*e*AR_h));
CL_h=a_h*(angle(1:1:24)-alfa0_h);       % from -4deg to 7.5deg
CDi_h=zeros(1,24);
CD_h=zeros(1,24);
for i=1:1:24
    CDi_h(i)=CL_h(i)^2/(3.14*e*AR_h);
    CD_h(i)=cd_h(i)+CDi_h(i);
end
CDi_h;
CD_h;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%       Vertical Tail        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a_v=a0_v/(1+(57.3*a0_v)/(3.14*e*AR_v));
CL_v=a_v*(angle(1:1:24)-alfa0_v);       % from -4deg to 7.5deg
CDi_v=zeros(1,24);
CD_v=zeros(1,24);
for i=1:1:24
    CDi_v(i)=CL_v(i)^2/(3.14*e*AR_v);
    CD_v(i)=cd_v(i)+CDi_v(i);
end
CDi_v;
CD_v;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%          Fuselage          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
CD_f=0.007;




% cl=0.6;
% v=14.5;
% qdyn=0.5*rho*v^2;
% Re=rho*v*MAC_w/miu
% L=qdyn*cl*S_w
% G=m_tot*g

% position of cg


